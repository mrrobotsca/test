# Récuperation des donnés DJ

[![N|Solid](data:image/png;base64,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)](https://nodesource.com/products/nsolid)



[![Build Status](https://travis-ci.org/joemccann/dillinger.svg?branch=master)](https://travis-ci.org/joemccann/dillinger)

[![N|](https://raw.githubusercontent.com/mrrobotsca/test/master/ezgif.com-video-to-gif.gif)]()

# INTRODUCTION

Nous voulons effectuer des requêtes automatiques afin de capturer et déposer dans un répertoire centralisé les fichiers qui sont gardés en mémoire sur les relais des disjoncteurs télécommandés du réseau électrique de HQD.

Notre objectif est de donner accès à une centaine d’utilisateurs (ingénieurs et techniciens) de HQD afin d’analyser les événements des disjoncteurs.


# DESCRIPTION GÉNÉRALE

#### BESOIN D’AFFAIRES

Le besoin d’affaires est de diminuer la fréquence et les déplacements inutiles de patrouilleurs sur les lignes de HQD. Ceci nous aidera à diminuer, expliquer, prévenir les plaintes clients.


# PÉRIMÈTRE DU PROJET 

LE PROJET COUVRE LE PÉRIMÈTRE SUIVANT :


  - 1800 disjoncteurs en ligne
  - 1/3 sont télécommandés et en augmentation sur le réseau.
  - Il y a donc environ 600 disjoncteurs télécommandés que nous pouvons interroger.
  - Modèle des relais de disjoncteurs : SEL 351 et SEL 651
  - Fichiers à capturer
  - SEL 351 fichiers [*.cev ]
  - SEL 651 fichiers [ *.dat  *.hdr  *.cfg  ] comtrade
  - Nous pouvons déjà aller capturer ces fichiers en mode manuel.
  - Ce projet doit automatiser cette fonction.
  - Capturer et déposer dans un répertoire indexé tous les fichiers ci-dessus.
  - Rendre accessible ces fichiers à une centaine d’utilisateurs.

### Libraries

Libraries externs utilisés:

* [PySerial](https://pyserial.readthedocs.io/en/latest/pyserial_api.html) - pySerial API
* [Pandas](https://pandas.pydata.org/) - Python Data Analysis Library


### Installation

Tout d'abord, il faut créer notre environement virtuel à l'aide anaconda  [Anaconda](https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html).

```sh
$ conda create --name MonEnv --file spec-file.txt
$ conda activate MonEnv
```

# Compilation et Création .Exe

```sh
$ pyinstaller --onefile RecupDj.py
```

### Transferer le fichier .EXE dans les serveur de maintenance
Dans cet exemple , on transfère le fichier exécutable dans un répertoire accessible dans tous les serveurs de maintenance. 
```sh
$ copy /Y "Votre path du repertoire\RecupDj.exe" "Z:\Scripts(tous)\Lire_Info_du_SEL351R\Programmes MAT"
```

# Structure du programme


| Methode | Fonction |
| ------ | ------ |
|  urlify(s) | Remplacer tous les espaces blancs par un seul tiret |
| His_Analyse(lclcl,info_recup_path) | Analyse l'écart entre le nouveau fichier HIS extrait avec le fichier de Events.csv |
| timeout_handler(signum, frame) | Gestionnaire des timeouts  |
| end_subprocess_fct(p) | Met fin à notre subprocess |
| Lire_donnees_SEL351R(ced_lclcl, ser_comm_obj) | Fonctionne principal qui lis les donnés demandés au DJ , écrire dans des fichier désiré ( .CEV , .CSV ) |
| Lire_donnees_HIS(ced_lclcl, ser_comm_obj) | En mode auto, cette methode permet de extrait un nouveau Ficher HIS pour pouvoir comparer et detectrer  |
| get_info_sel351r(ced_lclcl, adr_ip_tunnel) | Focntion qui monte le passthrough et Ramasse les donnees du SEL351R. Lancement de SMP4 |
| Startup_validation_CED() | La fonctionne qui prend 2em argument entrée au moment de lancement du programme pour l'associer au bon CED (territoire: LAV, MAT, MTL, et etc) |
| GET_ini() |  La fonctionne qui prend 3em argument entrée au moment de lancement du programme pour l'associer au bon Fichier de .ini  |
| read_config_file() |  La fonctionne qui lit les parametre configuré dans le fichier .INI et l'associer au bon parametre du programme |
| init_logging() | La fonctionne qui initie le [Logging](https://docs.python.org/2/library/logging.html) et qui enregistre tous les logs dans le dossier désiré |
| init_resume() | La fonctionne qui initie le log file des Print() et qui enregistre le résumé tous les logs dans le dossier désiré |
| init_stop() | La fonctionne qui arrete le log file des Print()  |
| get_liste_lclcl() | La fonctionne qui lit tous les paramtres dans la liste des LCLCLs du territoire désiré  |
| send_command(command_to_send) | La fonction qui envoit les commandes désirés implementés dans le fichier ,INI . Exemple : HIS, EVE , EVE C .   |
| read_data() | La foction qui lis les donnés envoyé par SMP4. Lecture ligne par ligne et décode chaque ligne (bit-->string) |
| log_into_SEL351R() | La foction qui initie le [Serial](https://pythonhosted.org/pyserial/) et envois des commandes d'accés administrateur au SMP4 |
| detect_actual_level(actual_level, ser_comm_obj) | La fonction qui détécte le niveau d'administrateur ( Level, 1,2,3) |


License
----

MIT
